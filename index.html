<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>يوسف — نشر البرومبتات</title>
  <style>
    :root{--accent:#0ea5a3;--bg:#0f172a;--card:#0b1220;--glass:rgba(255,255,255,0.04)}
    *{box-sizing:border-box;font-family: Cairo, 'Segoe UI', Tahoma, sans-serif}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071029 0%, #0b1220 100%);color:#e6eef6}
    header{display:flex;align-items:center;justify-content:space-between;padding:18px 24px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#2563eb);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;color:white}
    h1{margin:0;font-size:18px}
    p.lead{margin:0;color:#9fb3c7;font-size:13px}
    main{padding:20px;max-width:1100px;margin:18px auto}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:18px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(3,7,18,0.6)}
    label{font-size:13px;color:#bcd5df}
    input[type=text],textarea,select{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
    textarea{min-height:120px;resize:vertical}
    button{background:var(--accent);border:none;color:#052022;padding:10px 12px;border-radius:10px;font-weight:600;cursor:pointer}
    .muted{color:#92a9b9;font-size:13px}
    .posts{display:flex;flex-direction:column;gap:12px}
    .post{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
    .post .meta{display:flex;justify-content:space-between;gap:8px;align-items:center}
    .post .content{white-space:pre-wrap;margin-top:10px;font-family:inherit}
    .actions{display:flex;gap:8px;margin-top:10px}
    .chip{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;font-size:13px}
    .search{display:flex;gap:8px;margin-bottom:12px}
    .empty{color:#7f98a9;text-align:center;padding:40px 10px}
    footer{max-width:1100px;margin:10px auto;text-align:center;color:#7da9bb;font-size:13px}
    @media(max-width:880px){.grid{grid-template-columns:1fr}header{flex-wrap:wrap;gap:8px}.brand p{display:none}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">يوسف</div>
      <div>
        <h1>يوسف</h1>
        <p class="lead">منصة بسيطة لنشر ومشاركة البرومبتات — أنشر، انسخ، وجرّب</p>
      </div>
    </div>
    <div class="muted">محليًا محفوظ في متصفحك · للتشغيل زمنياً أو النشر استخدم GitHub Pages أو Firebase</div>
  </header>

  <main>
    <div class="grid">
      <aside class="card">
        <h3>انشر برومت جديد</h3>
        <div style="height:8px"></div>
        <label>اسم المبدع (اختياري)</label>
        <input id="author" type="text" placeholder="مثال: يوسف" />

        <label>عنوان مختصر (اختياري)</label>
        <input id="title" type="text" placeholder="عنوان للبرومت" />

        <label>نص البرومت</label>
        <textarea id="prompt" placeholder="اكتب البرومت هنا... مثال: 'أعطني قصة قصيرة عن...'" ></textarea>

        <label>وسم/تصنيف (اختياري)</label>
        <input id="tag" type="text" placeholder="مثال: محادثة، صورة، ترجمة" />

        <div style="height:12px"></div>
        <div style="display:flex;gap:8px">
          <button id="publishBtn">نشر</button>
          <button id="clearBtn" style="background:#334155;color:#e6eef6">مسح الحقول</button>
        </div>

        <div style="height:12px"></div>
        <div class="muted">نصيحة: استخدم وصفًا دقيقًا واختبر البرومت في النموذج الذي ستستخدمه (مثل ChatGPT أو Midjourney).</div>
      </aside>

      <section>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
            <div style="flex:1;display:flex;gap:8px;align-items:center">
              <input id="searchInput" type="text" placeholder="ابحث في العناوين أو النص أو الوسوم" />
              <select id="filterTag"><option value="">تصفية حسب الوسم</option></select>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <button id="exportBtn" style="background:#2b6cb0">تصدير JSON</button>
              <button id="importBtn" style="background:#1f2937">استيراد</button>
              <input id="importFile" type="file" accept="application/json" style="display:none" />
            </div>
          </div>

          <div id="postsContainer" class="posts"></div>
          <div id="emptyState" class="empty" style="display:none">لا توجد برومبتات بعد — كن أول من ينشر!</div>
        </div>

        <div style="height:12px"></div>
        <div class="card" style="padding:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <div class="chip">محفوظ في: localStorage</div>
          <div class="chip">عدد البرومبتات: <span id="count">0</span></div>
          <div class="chip">نسخة احتياطية: استخدم زر تصدير</div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    تمّ التصميم بواسطة "يوسف" — يمكنك حفظ الملف كـ index.html ثم فتحه في متصفحك. للمساعدة في النشر: اطلب مني خطوات نشر على GitHub Pages أو Firebase.
  </footer>

  <script>
    // بسيط: إدارة منشورات البرومبت في localStorage
    const STORAGE_KEY = 'yousef_prompts_v1';
    let posts = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    const el = id => document.getElementById(id);
    const render = () => {
      const container = el('postsContainer');
      container.innerHTML = '';
      const filter = el('filterTag').value.trim();
      const q = el('searchInput').value.trim().toLowerCase();
      const visible = posts.filter(p => {
        if(filter && p.tag !== filter) return false;
        if(!q) return true;
        return (p.title||'').toLowerCase().includes(q) || p.prompt.toLowerCase().includes(q) || (p.author||'').toLowerCase().includes(q) || (p.tag||'').toLowerCase().includes(q);
      }).sort((a,b)=>b.createdAt - a.createdAt);

      if(visible.length===0){ el('emptyState').style.display='block'; } else { el('emptyState').style.display='none'; }

      visible.forEach(p=>{
        const div = document.createElement('div'); div.className='post';
        div.innerHTML = `
          <div class="meta">
            <div>
              <strong>${escapeHtml(p.title || 'بدون عنوان')}</strong>
              <div class="muted">${escapeHtml(p.author || 'مجهول')} · ${new Date(p.createdAt).toLocaleString('ar-EG')}</div>
            </div>
            <div style="text-align:left;min-width:140px">
              <span class="chip">${escapeHtml(p.tag||'عام')}</span>
            </div>
          </div>
          <div class="content">${escapeHtml(p.prompt)}</div>
          <div class="actions">
            <button onclick='copyPrompt("${p.id}")'>نسخ</button>
            <button onclick='toggleLike("${p.id}")'>${p.likes||0} ❤️</button>
            <button onclick='editPrompt("${p.id}")' style="background:#f97316">تعديل</button>
            <button onclick='deletePrompt("${p.id}")' style="background:#ef4444">حذف</button>
          </div>
        `;
        container.appendChild(div);
      });

      el('count').innerText = posts.length;
      refreshFilterOptions();
    }

    function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(posts)); render(); }

    function uid(){ return 'id_'+Math.random().toString(36).slice(2,9); }

    document.getElementById('publishBtn').addEventListener('click', ()=>{
      const prompt = el('prompt').value.trim(); if(!prompt){ alert('اكتب نص البرومت قبل النشر.'); return; }
      const post = {
        id: uid(),
        title: el('title').value.trim(),
        author: el('author').value.trim(),
        tag: el('tag').value.trim(),
        prompt: prompt,
        createdAt: Date.now(),
        likes: 0
      };
      posts.push(post); save(); // نظيف: افراغ الحقول
      el('title').value=''; el('prompt').value=''; el('tag').value='';
    });

    el('clearBtn').addEventListener('click', ()=>{ el('title').value=''; el('prompt').value=''; el('tag').value=''; el('author').value=''; });

    function copyPrompt(id){ const p = posts.find(x=>x.id===id); if(!p) return; navigator.clipboard.writeText(p.prompt).then(()=>{ alert('نُسخ النص إلى الحافظة!'); }); }

    function deletePrompt(id){ if(!confirm('هل تريد حذف هذا البرومت؟')) return; posts = posts.filter(x=>x.id!==id); save(); }

    function editPrompt(id){ const p = posts.find(x=>x.id===id); if(!p) return; const newText = prompt('حرر نص البرومت:', p.prompt); if(newText===null) return; p.prompt = newText; p.title = prompt('غير العنوان (اترك فارغًا للإبقاء):', p.title) || p.title; save(); }

    function toggleLike(id){ const p = posts.find(x=>x.id===id); if(!p) return; p.likes = (p.likes||0) + 1; save(); }

    function refreshFilterOptions(){ const select = el('filterTag'); const tags = Array.from(new Set(posts.map(p=>p.tag).filter(Boolean))); const old = select.value; select.innerHTML = '<option value="">تصفية حسب الوسم</option>' + tags.map(t=>`<option value="${escapeHtml(t)}">${escapeHtml(t)}</option>`).join(''); if(tags.includes(old)) select.value = old; }

    el('filterTag').addEventListener('change', render);
    el('searchInput').addEventListener('input', render);

    // تصدير واستيراد
    el('exportBtn').addEventListener('click', ()=>{
      const data = JSON.stringify(posts, null, 2);
      const blob = new Blob([data],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='yousef_prompts_backup.json'; a.click(); URL.revokeObjectURL(url);
    });

    el('importBtn').addEventListener('click', ()=> el('importFile').click());
    el('importFile').addEventListener('change', e=>{
      const f = e.target.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ev => {
        try{ const arr = JSON.parse(ev.target.result); if(!Array.isArray(arr)) throw 0; posts = arr; save(); alert('تم الاستيراد.'); }catch(err){ alert('ملف غير صالح'); }
      }; reader.readAsText(f);
    });

    // init
    render();
  </script>
</body>
</html>